# Independent-Study

For this assignment, you will run AFL to fuzz libtiff's thumbnail program and gather various fuzzing results. You will need to write up a report containing the fuzzing results and submit it to the "Homework 1" submission folder on D2L.

1.   Retrive the source code of libtiff on the course Linux server

Log into the course Linux server and extract the file tiff-4.0.3.tar.gz from /home/zhuang/public/ to the directory of your choice. For example:

$ mkdir afl
$ tar xvf /home/zhuang/public/tiff-4.0.3.tar.gz

2.   Configure libtiff for compilation using AFL:

$ cd tiff-4.0.3
$ CC=/home/zhuang/public/afl-2.52b/afl-gcc CXX=/home/zhuang/public/afl-2.52b/afl-g++ ./configure --enable-static --disable-shared

3.   Compile libtiff using AFL:

$ make clean
$ make -j4
The compilation will instrument the code needed by AFL into libtiff.


4.   Prepare initial inputs (TIF image files) for AFL to fuzz libtiff:

$ mkdir fuzzing
$ cd fuzzing
$ tar xvf /home/zhuang/public/input.tgz
This step will create an input directory containing some TIF image files. You can verify that using the ls input command.


5.   Run AFL to fuzz libtiff's thumbnail program:

$ /home/zhuang/public/afl-2.52b/afl-fuzz -i input -o output -- ../tools/thumbnail @@ temp.tif

6.   Gather fuzzing results:

Let AFL run for 1 hour and take a screenshot of the information displayed by AFL. Your screenshot should look like the one below:
![image](https://user-images.githubusercontent.com/117532663/231228351-fa92071d-ba55-4468-b477-56f4c1c6967e.png)

Examine the inputs generated by AFL and caused crashes.
$ ls output/crashes
The
ls

command should list some input files like below:


id:000000,sig:11,src:000000,op:flip1,pos:198
id:000001,sig:11,src:000000,op:flip2,pos:234
id:000002,sig:06,src:000000,op:flip2,pos:272
id:000003,sig:06,src:000000,op:flip2,pos:284
id:000004,sig:11,src:000000,op:flip2,pos:306
id:000005,sig:11,src:000000,op:flip2,pos:306
id:000006,sig:11,src:000000,op:flip2,pos:318
id:000007,sig:11,src:000000,op:arith8,pos:186,val:+26
id:000008,sig:11,src:000000,op:arith8,pos:198,val:+23
id:000009,sig:11,src:000000,op:arith8,pos:222,val:+18
id:000010,sig:11,src:000000,op:arith8,pos:246,val:+14
id:000011,sig:11,src:000000,op:arith8,pos:258,val:+13
README.txt


Select one of the crashing inputs and try to reproduce the crash. For example, you can run thumbnail with one crashing input file:
$ ../tools/thumbnail output/crashes/id:000000,sig:11,src:000000,op:flip1,pos:198 temp.tif
And you should see a crash message
"Segmentation fault"

at the end of the output. If you don't see any crash, you should choose another input file in the
crashes

directory until you can reproduce a crash.



Once you have reproduced a crash, you will need to find out the program location where the crash occurs. You can use the gdb debugger for this. Below is an example use of gdb:
$ gdb --args ../tools/thumbnail output/crashes/id:000000,sig:11,src:000000,op:flip1,pos:198 temp.tif
(gdb) r
And
gdb

will run thumbnail with the crashing input and display the program location where the crash occurs in a message similar to the following one:


Program received signal SIGSEGV, Segmentation fault.
0x000000000041a964 in checkInkNamesString (s=0x0, slen=15840, tif=0x743010)
at tif_dir.c:139
139 for (; cp < ep && *cp != '\0'; cp++) {}


From this message, we see that the thumbnail program crashed in a
checkInkNamesString

function at line 139 in the source code file
tif_dir.c
